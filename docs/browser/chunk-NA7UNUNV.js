import{b as fe,c as Ce,d as ye,g as be,h as ve,i as Se,j as Me,k as Te,m as Ee,n as Ve,o as Ie,q as ke,s as De,t as Be,u as Fe,v as Pe,w as We,x as Re}from"./chunk-COKCAMEL.js";import{A as z,Ac as we,B as I,Bc as Ue,D as c,E as d,Fa as J,Ga as p,Ha as F,I as G,Ia as P,Ib as L,J as k,Ja as Q,Jb as te,Ka as h,La as C,Ma as y,O as D,Pa as U,Qa as M,Qb as T,V as u,Vb as ie,W as E,a as j,ac as ne,bb as X,bc as oe,cc as re,d as v,db as Y,dc as ae,fc as se,gb as W,ha as _,hb as Z,hc as le,ic as ue,ja as m,jb as H,kb as $,kc as me,lc as pe,ma as B,mb as ee,mc as ce,nc as q,oa as K,oc as de,pa as a,pc as w,qa as s,qc as _e,ra as S,rc as ge,sa as A,ta as N,va as f,vc as xe,wa as x,wc as he,xa as l}from"./chunk-YME6T3XJ.js";var R=(()=>{let o=class o extends _e{constructor(n,t,r){super(n,r),this.messageService=t}getUsuarios(){return this.http.get(`${w.microproxy_seguridad}usuarios`)}postCrearUsuario(n){return this.http.post(`${w.microproxy_seguridad}usuarios`,n)}postRegistrarUsuario(n){return this.http.post(`${w.microproxy_seguridad}usuarios/registrar`,n)}putActualizarUsuario(n){return this.http.put(`${w.microproxy_seguridad}usuarios`,n)}eliminarUsuarios(n){for(let t of n){let r={headers:new H({"Content-Type":"application/json"}),body:t};this.http.delete(`${w.microproxy_cursos}usuarios`,r).subscribe({next:b=>v(this,null,function*(){this.messageService.add({severity:"success",summary:"Eliminado",detail:`Usuario ${t.nombre} eliminado`,life:3e3})}),error:b=>{n=n.filter(g=>g.id!=t.id),this.messageService.add({severity:"error",summary:"Atenci\xF3n",detail:b.statusText,life:3e3})}})}return n}deleteEliminarUsuario(n){let t={headers:new H({"Content-Type":"application/json"}),body:n};this.http.delete(`${w.microproxy_seguridad}usuarios`,t).subscribe({next:r=>v(this,null,function*(){this.messageService.add({severity:"success",summary:"Eliminado",detail:`Usuario ${n.nombre} eliminado`,life:3e3})}),error:r=>{this.messageService.add({severity:"error",summary:"Atenci\xF3n",detail:r.statusText,life:3e3})}})}};o.\u0275fac=function(t){return new(t||o)(D($),D(T),D(ge))},o.\u0275prov=G({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();function qe(i,o){if(i&1){let e=f();a(0,"button",16),x("click",function(){c(e);let t=l(2);return d(t.openNew())}),s()}}function Oe(i,o){if(i&1){let e=f();a(0,"button",17),x("click",function(){c(e);let t=l(2);return d(t.deleteSelectedUsuarios())}),s()}if(i&2){let e=l(2);m("disabled",!e.selectedUsuarios||!e.selectedUsuarios.length)}}function ze(i,o){if(i&1&&(a(0,"div",13),_(1,qe,1,0,"button",14)(2,Oe,1,1,"button",15),s()),i&2){let e=l();u(),m("ngIf",e.tokenService.isAdmin()),u(),m("ngIf",e.tokenService.isAdmin()&&e.usuarios&&e.usuarios.length>0)}}function Ge(i,o){if(i&1&&(a(0,"h5",19),p(1),s()),i&2){let e=l(2);u(),P("Total ",e.usuarios.length," Usuario")}}function Ke(i,o){if(i&1&&_(0,Ge,2,1,"h5",18),i&2){let e=l();m("ngIf",e.usuarios&&e.usuarios.length>0)}}function Je(i,o){if(i&1){let e=f();a(0,"div",25)(1,"h5",19),p(2,"Plataformas"),s(),a(3,"span",26),S(4,"i",27),a(5,"input",28),x("input",function(t){c(e),l();let r=J(2),b=l();return d(b.onGlobalFilter(r,t))}),s()()()}}function Qe(i,o){i&1&&(a(0,"th",31),S(1,"p-tableHeaderCheckbox"),s())}function Xe(i,o){if(i&1&&(a(0,"tr"),_(1,Qe,2,0,"th",29),a(2,"th",30),p(3,"Plataforma"),s()()),i&2){let e=l(2);u(),m("ngIf",e.tokenService.isAdmin())}}function Ye(i,o){if(i&1&&(a(0,"td"),S(1,"p-tableCheckbox",41),s()),i&2){let e=l().$implicit;u(),m("value",e)}}function Ze(i,o){if(i&1){let e=f();a(0,"div",42)(1,"button",43),x("click",function(){c(e);let t=l().$implicit,r=l(2);return d(r.editUsuario(t))}),s(),a(2,"button",44),x("click",function(){c(e);let t=l().$implicit,r=l(2);return d(r.deleteUsuario(t))}),s()()}}function $e(i,o){if(i&1&&(a(0,"tr"),_(1,Ye,2,1,"td",6),a(2,"td")(3,"div",32)(4,"div",33)(5,"div",34)(6,"div",35),p(7),s(),a(8,"div",36),p(9),s(),a(10,"div",36),p(11),s()(),a(12,"div",37),_(13,Ze,3,0,"div",38),a(14,"div",39)(15,"p")(16,"span",40),p(17,"Creado el: "),s(),p(18),s()(),a(19,"div")(20,"p")(21,"span",40),p(22,"Ultima actualizaci\xF3n: "),s(),p(23),s()()()()()()()),i&2){let e=o.$implicit,n=l(2);u(),m("ngIf",n.tokenService.isAdmin()),u(6),Q("",e.codigo,"-",e.nombre,""),u(2),P("Correo: ",e.email,""),u(2),P("Rol: ",e.rol?e.rol.codigo:"Sin rol",""),u(2),m("ngIf",n.tokenService.isAdmin()),u(5),F(n.datePipe.transform(e.createdAt,"dd/MM/yyyy HH:MM:SS")),u(5),F(n.datePipe.transform(e.updateAt,"dd/MM/yyyy HH:MM:SS"))}}var et=()=>["codigo","nombre","descripcion"],tt=()=>[10,20,30];function it(i,o){if(i&1){let e=f();A(0),a(1,"p-table",20,21),y("selectionChange",function(t){c(e);let r=l();return C(r.selectedUsuarios,t)||(r.selectedUsuarios=t),d(t)}),_(3,Je,6,0,"ng-template",22)(4,Xe,4,1,"ng-template",23)(5,$e,24,8,"ng-template",24),s(),N()}if(i&2){let e=l();u(),m("value",e.usuarios)("scrollable",!0)("columns",e.cols)("rows",2)("globalFilterFields",U(10,et))("paginator",!0)("rowsPerPageOptions",U(11,tt))("showCurrentPageReport",!0),h("selection",e.selectedUsuarios),m("rowHover",!0)}}function nt(i,o){i&1&&(A(0),a(1,"h1",30),p(2,"No tienes usuarios registrados"),s(),N())}var V=i=>({"ng-invalid ng-dirty":i});function ot(i,o){if(i&1){let e=f();a(0,"div",46)(1,"label",53),p(2,"Codigo"),s(),a(3,"input",54),y("ngModelChange",function(t){c(e);let r=l(2);return C(r.usuario.codigo,t)||(r.usuario.codigo=t),d(t)}),s()()}if(i&2){let e=l(2);u(3),h("ngModel",e.usuario.codigo),m("ngClass",M(2,V,e.submitted&&!e.usuario.codigo))}}function rt(i,o){i&1&&(a(0,"small",56),p(1,"El codigo es requerido."),s())}function at(i,o){if(i&1){let e=f();a(0,"div",46)(1,"label",53),p(2,"Codigo"),s(),a(3,"input",55),y("ngModelChange",function(t){c(e);let r=l(2);return C(r.usuario.codigo,t)||(r.usuario.codigo=t),d(t)}),s(),_(4,rt,2,0,"small",49),s()}if(i&2){let e=l(2);u(3),h("ngModel",e.usuario.codigo),m("ngClass",M(3,V,e.submitted&&!e.usuario.codigo)),u(),m("ngIf",e.submitted&&!e.usuario.codigo)}}function st(i,o){i&1&&(a(0,"small",56),p(1,"El nombre es requerido."),s())}function lt(i,o){i&1&&(a(0,"small",56),p(1,"El email es requerido."),s())}function ut(i,o){if(i&1){let e=f();_(0,ot,4,4,"div",45)(1,at,5,5),a(2,"div",46)(3,"label",47),p(4,"Nombre"),s(),a(5,"input",48),y("ngModelChange",function(t){c(e);let r=l();return C(r.usuario.nombre,t)||(r.usuario.nombre=t),d(t)}),s(),_(6,st,2,0,"small",49),s(),a(7,"div",46)(8,"label",50),p(9,"Email"),s(),a(10,"input",48),y("ngModelChange",function(t){c(e);let r=l();return C(r.usuario.email,t)||(r.usuario.email=t),d(t)}),s(),_(11,lt,2,0,"small",49),s(),a(12,"div",46)(13,"label",51),p(14,"Contrase\xF1a"),s(),a(15,"input",52),y("ngModelChange",function(t){c(e);let r=l();return C(r.usuario.pass,t)||(r.usuario.pass=t),d(t)}),s()()}if(i&2){let e=l();K(0,e.usuario.id?0:1),u(5),h("ngModel",e.usuario.nombre),m("ngClass",M(9,V,e.submitted&&!e.usuario.nombre)),u(),m("ngIf",e.submitted&&!e.usuario.nombre),u(4),h("ngModel",e.usuario.email),m("ngClass",M(11,V,e.submitted&&!e.usuario.email)),u(),m("ngIf",e.submitted&&!e.usuario.email),u(4),h("ngModel",e.usuario.pass),m("ngClass",M(13,V,e.submitted&&!e.usuario.pass))}}function mt(i,o){if(i&1){let e=f();a(0,"button",57),x("click",function(){c(e);let t=l();return d(t.hideDialog())}),s(),a(1,"button",58),x("click",function(){c(e);let t=l();return d(t.saveUsuarios())}),s()}}function pt(i,o){if(i&1&&(a(0,"span"),p(1,"\xBFEsta seguro/a de eliminar la plataforma "),a(2,"b"),p(3),s(),p(4,"?"),s()),i&2){let e=l();u(3),F(e.usuario.nombre)}}function ct(i,o){if(i&1){let e=f();a(0,"button",59),x("click",function(){c(e);let t=l();return d(t.deleteUsuarioDialog=!1)}),s(),a(1,"button",60),x("click",function(){c(e);let t=l();return d(t.confirmDelete())}),s()}}function dt(i,o){if(i&1){let e=f();a(0,"button",59),x("click",function(){c(e);let t=l();return d(t.deleteUsuariosDialog=!1)}),s(),a(1,"button",60),x("click",function(){c(e);let t=l();return d(t.confirmDeleteSelected())}),s()}}var _t=()=>({width:"500px"}),je=()=>({width:"450px"}),Ae=(()=>{let o=class o{constructor(n,t,r,b){this.usuarioService=n,this.messageService=t,this.datePipe=r,this.tokenService=b,this.usuarios=[],this.usuariosEdit=[],this.usuario={},this.selectedUsuarios=[],this.usuarioDialog=!1,this.deleteUsuarioDialog=!1,this.deleteUsuariosDialog=!1,this.submitted=!1,this.cols=[],this.rowsPerPageOptions=[5,10,20]}ngOnInit(){this.usuarioService.getUsuarios().subscribe({next:n=>v(this,null,function*(){if(n.length>0){this.usuarios=n;for(let t of this.usuarios)t.pass=void 0}else this.messageService.add({severity:"warn",summary:"Sin informaci\xF3n",detail:"No tienes usuarios registrados",life:3e3})}),error:n=>{this.messageService.add({severity:"error",summary:"Atenci\xF3n",detail:n.statusText,life:3e3})}}),this.cols=[{field:"usuario",header:"Usuario"}]}openNew(){this.usuario={},this.submitted=!1,this.usuarioDialog=!0}deleteSelectedUsuarios(){this.deleteUsuariosDialog=!0}editUsuario(n){this.usuario=j({},n),this.usuarioDialog=!0}deleteUsuario(n){this.deleteUsuarioDialog=!0,this.usuario=j({},n),this.selectedUsuarios.push(this.usuario)}confirmDeleteSelected(){return v(this,null,function*(){this.deleteUsuariosDialog=!1,this.selectedUsuarios=this.usuarioService.eliminarUsuarios(this.selectedUsuarios),this.usuarios=this.usuarios.filter(n=>!this.selectedUsuarios.includes(n)),this.selectedUsuarios=[]})}confirmDelete(){this.deleteUsuarioDialog=!1,this.usuarioService.deleteEliminarUsuario(this.usuario),this.usuarios=this.usuarios.filter(n=>n.id!==this.usuario.id),this.usuario={}}hideDialog(){this.usuarioDialog=!1,this.submitted=!1}saveUsuarios(){this.submitted=!0,this.usuariosEdit=this.usuarios,this.usuario.codigo?.trim()&&this.usuario.nombre?.trim()&&(this.usuario.id?this.usuarioService.putActualizarUsuario(this.usuario).subscribe({next:n=>v(this,null,function*(){this.usuario.pass=void 0,this.usuariosEdit[this.findIndexById(this.usuario.codigo)]=yield this.usuario,this.messageService.add({severity:"success",summary:"Successful",detail:"Usuario Actualizado",life:3e3})}),error:n=>{if(this.usuario.pass=void 0,typeof n.error.statusMessage.statusMessage=="string")this.messageService.add({severity:"error",summary:"Atenci\xF3n",detail:n.error.statusMessage.statusMessage,life:3e3});else for(let t of n.error.statusMessage.message)this.messageService.add({severity:"error",summary:"Atenci\xF3n",detail:t,life:3e3})}}):(this.usuario.rol={id:0},this.usuarioService.postRegistrarUsuario(this.usuario).subscribe({next:n=>v(this,null,function*(){this.usuario.pass=void 0,this.usuariosEdit.push(n),this.messageService.add({severity:"success",summary:"Successful",detail:"Usuario Creado",life:3e3})}),error:n=>{if(this.usuario.pass=void 0,typeof n.error.statusMessage.statusMessage=="string")this.messageService.add({severity:"error",summary:"Atenci\xF3n",detail:n.error.statusMessage.statusMessage,life:3e3});else for(let t of n.error.statusMessage.message)this.messageService.add({severity:"error",summary:"Atenci\xF3n",detail:t,life:3e3})}})),this.usuarioDialog=!1)}findIndexById(n){let t=-1;for(let r=0;r<this.usuarios.length;r++)if(this.usuarios[r].codigo===n){t=r;break}return t}onGlobalFilter(n,t){n.filterGlobal(t.target.value,"contains")}};o.\u0275fac=function(t){return new(t||o)(E(R),E(T),E(W),E(te))},o.\u0275cmp=z({type:o,selectors:[["app-usuario"]],decls:23,vars:18,consts:[[1,"grid"],[1,"col-12","p-0","lg:p-3"],[1,"card","px-3","py-3","lg:px-5","lg:py-5"],["styleClass","mb-4"],["pTemplate","left"],["pTemplate","right"],[4,"ngIf"],["header","Detalles de la Plataforma",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Confirmar eliminaci\xF3n",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[1,"my-2"],["pButton","","pRipple","","label","Nueva","icon","pi pi-plus","class","p-button-success mr-2 p-2",3,"click",4,"ngIf"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash","class","p-button-danger p-2",3,"disabled","click",4,"ngIf"],["pButton","","pRipple","","label","Nueva","icon","pi pi-plus",1,"p-button-success","mr-2","p-2",3,"click"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash",1,"p-button-danger","p-2",3,"disabled","click"],["class","m-0",4,"ngIf"],[1,"m-0"],["scrollDirection","both","scrollHeight","400px","responsiveLayout","scroll","currentPageReportTemplate","Viendo {first} a {last} de {totalRecords} usuarios","selectionMode","multiple","dataKey","id",3,"value","scrollable","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto",3,"input"],["style","width: 3rem",4,"ngIf"],[1,"text-center"],[2,"width","3rem"],[1,"flex","flex-row","xl:align-items-start","p-4","gap-4","align-items-center",2,"width","600px !important"],[1,"flex","flex-row","justify-content-between","align-items-start","flex-1","gap-4"],[1,"flex","flex-column","align-items-center","sm:align-items-start","gap-2"],[1,"text-2xl","font-bold","text-900"],[1,"text-2","font-bold","text-700"],[1,"flex","flex-column"],["class","flex",4,"ngIf"],[1,"mt-4"],[1,"font-bold"],[3,"value"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],["class","field"],[1,"field"],["for","nombre"],["type","text","pInputText","","id","name","maxlength","200","required","","autofocus","",3,"ngModel","ngClass","ngModelChange"],["class","ng-dirty ng-invalid",4,"ngIf"],["for","email"],["for","pass"],["type","text","pInputText","","id","name","minlength","10","autofocus","",3,"ngModel","ngClass","ngModelChange"],["for","codigo"],["type","text","pInputText","","id","codigo","disabled","","required","","autofocus","",3,"ngModel","ngClass","ngModelChange"],["type","text","pInputText","","id","codigo","required","","autofocus","",3,"ngModel","ngClass","ngModelChange"],[1,"ng-dirty","ng-invalid"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-check",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Si",1,"p-button-text",3,"click"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),S(3,"p-toast"),a(4,"p-toolbar",3),_(5,ze,3,2,"ng-template",4)(6,Ke,1,1,"ng-template",5),s(),_(7,it,6,12,"ng-container",6)(8,nt,3,0,"ng-container",6),s(),a(9,"p-dialog",7),y("visibleChange",function(g){return C(r.usuarioDialog,g)||(r.usuarioDialog=g),g}),_(10,ut,16,15,"ng-template",8)(11,mt,2,0,"ng-template",9),s(),a(12,"p-dialog",10),y("visibleChange",function(g){return C(r.deleteUsuarioDialog,g)||(r.deleteUsuarioDialog=g),g}),a(13,"div",11),S(14,"i",12),_(15,pt,5,1,"span",6),s(),_(16,ct,2,0,"ng-template",9),s(),a(17,"p-dialog",10),y("visibleChange",function(g){return C(r.deleteUsuariosDialog,g)||(r.deleteUsuariosDialog=g),g}),a(18,"div",11),S(19,"i",12),a(20,"span"),p(21,"\xBFEsta seguro/a de eliminar las usuarios seleccionadas?"),s()(),_(22,dt,2,0,"ng-template",9),s()()()),t&2&&(u(7),m("ngIf",r.usuarios&&r.usuarios.length>0),u(),m("ngIf",!(r.usuarios&&r.usuarios.length>0)),u(),B(U(15,_t)),h("visible",r.usuarioDialog),m("modal",!0),u(3),B(U(16,je)),h("visible",r.deleteUsuarioDialog),m("modal",!0),u(3),m("ngIf",r.usuario),u(2),B(U(17,je)),h("visible",r.deleteUsuariosDialog),m("modal",!0))},dependencies:[X,Y,se,le,me,pe,ce,ue,re,ie,ye,be,ve,ne,we,Me,xe,Ve]});let i=o;return i})();var Ne=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=I({type:o}),o.\u0275inj=k({imports:[L.forChild([{path:"usuarios",component:Ae}]),L]});let i=o;return i})();var li=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=I({type:o}),o.\u0275inj=k({providers:[R,T,W],imports:[Z,Ne,q,de,ee,ae,Be,Se,Fe,q,oe,Ue,Te,Pe,he,Ee,fe,We,Ce,Ie,De,ke,Re]});let i=o;return i})();export{li as UsuariosModule};
